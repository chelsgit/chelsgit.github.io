<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÁâôÈÜ´Ë®∫ÊâÄÊéíÁè≠Á≥ªÁµ± - 2026Âπ¥1Êúà</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --primary-light: #dbeafe;
            --success: #059669;
            --success-light: #d1fae5;
            --warning: #d97706;
            --warning-light: #fef3c7;
            --danger: #dc2626;
            --danger-light: #fee2e2;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --counter: #8b5cf6;
            --counter-light: #ede9fe;
            --follow: #0891b2;
            --follow-light: #cffafe;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            min-height: 100vh;
            color: var(--gray-800);
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 24px 32px;
            border-radius: 16px;
            margin-bottom: 24px;
            box-shadow: 0 10px 40px rgba(37, 99, 235, 0.3);
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            background: white;
            padding: 8px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .tab {
            padding: 12px 24px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: var(--gray-600);
            transition: all 0.2s;
            font-family: inherit;
        }

        .tab:hover {
            background: var(--gray-100);
        }

        .tab.active {
            background: var(--primary);
            color: white;
        }

        /* Panels */
        .panel {
            display: none;
        }

        .panel.active {
            display: block;
        }

        /* Cards */
        .card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.06);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--gray-200);
            flex-wrap: wrap;
            gap: 12px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--gray-800);
        }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            font-family: inherit;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #047857;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(5, 150, 105, 0.3);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #b91c1c;
        }

        .btn-outline {
            background: white;
            border: 1px solid var(--gray-300);
            color: var(--gray-700);
        }

        .btn-outline:hover {
            background: var(--gray-50);
            border-color: var(--gray-400);
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
        }

        .btn-lg {
            padding: 14px 28px;
            font-size: 16px;
        }

        /* Employee List */
        .employee-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
        }

        .employee-card {
            background: var(--gray-50);
            border: 1px solid var(--gray-200);
            border-radius: 12px;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.2s;
        }

        .employee-card:hover {
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.1);
        }

        .employee-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 18px;
            flex-shrink: 0;
        }

        .employee-info {
            flex: 1;
            min-width: 0;
        }

        .employee-name {
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 4px;
        }

        .employee-stats {
            font-size: 12px;
            color: var(--gray-500);
        }

        .employee-actions {
            display: flex;
            gap: 8px;
            flex-shrink: 0;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: var(--gray-700);
            margin-bottom: 6px;
        }

        .form-input {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        /* Schedule Table */
        .schedule-container {
            overflow-x: auto;
            margin-top: 16px;
        }

        .schedule-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            min-width: 1400px;
        }

        .schedule-table th,
        .schedule-table td {
            padding: 8px;
            text-align: center;
            border: 1px solid var(--gray-200);
        }

        .schedule-table th {
            background: var(--gray-100);
            font-weight: 600;
            font-size: 13px;
            color: var(--gray-700);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .schedule-table th:first-child {
            position: sticky;
            left: 0;
            z-index: 20;
            background: var(--gray-200);
            min-width: 100px;
        }

        .schedule-table td:first-child {
            position: sticky;
            left: 0;
            background: var(--gray-50);
            font-weight: 600;
            z-index: 5;
            min-width: 100px;
        }

        .day-header {
            min-width: 110px;
        }

        .day-header .date {
            font-size: 16px;
            font-weight: 700;
        }

        .day-header .weekday {
            font-size: 11px;
            color: var(--gray-500);
        }

        .day-header.holiday {
            background: var(--danger-light) !important;
            color: var(--danger);
        }

        .day-header.saturday {
            background: var(--warning-light) !important;
        }

        .day-header.sunday {
            background: var(--gray-300) !important;
            color: var(--gray-500);
        }

        .schedule-cell {
            min-height: 90px;
            vertical-align: top;
            padding: 8px !important;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
        }

        .schedule-cell:hover {
            background: var(--primary-light);
        }

        .schedule-cell.no-session {
            background: var(--gray-100);
            color: var(--gray-400);
            cursor: default;
        }

        .schedule-cell.no-session:hover {
            background: var(--gray-100);
        }

        .staff-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            justify-content: center;
        }

        .staff-tag {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .staff-tag.counter {
            background: var(--counter-light);
            color: var(--counter);
            border: 1px solid var(--counter);
        }

        .staff-tag.follow {
            background: var(--follow-light);
            color: var(--follow);
            border: 1px solid var(--follow);
        }

        .vacancy-tag {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            background: var(--danger-light);
            color: var(--danger);
            border: 1px dashed var(--danger);
        }

        /* Session Labels */
        .session-label {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
            margin-bottom: 4px;
        }

        .session-morning {
            background: #fef3c7;
            color: #92400e;
        }

        .session-afternoon {
            background: #dbeafe;
            color: #1e40af;
        }

        .session-evening {
            background: #e0e7ff;
            color: #3730a3;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }

        .stat-card {
            background: var(--gray-50);
            border-radius: 10px;
            padding: 16px;
            text-align: center;
            border: 2px solid var(--gray-200);
            transition: all 0.3s;
        }

        .stat-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--gray-700);
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-target {
            font-size: 12px;
            color: var(--gray-500);
            margin-top: 4px;
        }

        .stat-card.complete {
            border-color: var(--success);
            background: var(--success-light);
        }

        .stat-card.complete .stat-value {
            color: var(--success);
        }

        .stat-card.over {
            border-color: var(--warning);
            background: var(--warning-light);
        }

        .stat-card.over .stat-value {
            color: var(--warning);
        }

        .stat-card.under .stat-value {
            color: var(--danger);
        }

        /* Leave Calendar */
        .leave-calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 6px;
            max-width: 500px;
        }

        .leave-calendar-header {
            text-align: center;
            font-weight: 600;
            font-size: 12px;
            color: var(--gray-600);
            padding: 8px;
        }

        .leave-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            border: 2px solid transparent;
            background: white;
        }

        .leave-day:hover:not(.empty):not(.sunday):not(.holiday) {
            background: var(--gray-100);
            border-color: var(--primary);
        }

        .leave-day.empty {
            cursor: default;
            background: transparent;
        }

        .leave-day.holiday {
            background: var(--gray-200);
            color: var(--gray-400);
            cursor: not-allowed;
        }

        .leave-day.selected {
            background: var(--danger) !important;
            color: white !important;
            border-color: var(--danger) !important;
        }

        .leave-day.sunday {
            color: var(--gray-400);
            background: var(--gray-100);
            cursor: not-allowed;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: white;
            border-radius: 16px;
            padding: 24px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: all 0.3s;
        }

        .modal-overlay.active .modal {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }

        .modal-close {
            width: 32px;
            height: 32px;
            border: none;
            background: var(--gray-100);
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
            color: var(--gray-600);
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: var(--gray-200);
        }

        .modal-footer {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
            padding-top: 16px;
            border-top: 1px solid var(--gray-200);
        }

        /* Action Bar */
        .action-bar {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
        }

        /* Legend */
        .legend {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin-top: 16px;
            padding: 12px 16px;
            background: var(--gray-50);
            border-radius: 8px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            color: var(--gray-600);
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }

        /* Summary Panel */
        .summary-panel {
            background: linear-gradient(135deg, var(--gray-800) 0%, var(--gray-900) 100%);
            color: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 16px;
        }

        .summary-item {
            text-align: center;
        }

        .summary-value {
            font-size: 32px;
            font-weight: 700;
        }

        .summary-label {
            font-size: 12px;
            opacity: 0.7;
            margin-top: 4px;
        }

        /* Checkbox styling */
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 14px;
            background: var(--gray-100);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
            font-size: 14px;
        }

        .checkbox-label:hover {
            background: var(--gray-200);
        }

        .checkbox-label.checked {
            border-color: var(--primary);
            background: var(--primary-light);
        }

        .checkbox-label.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .checkbox-label input {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: var(--gray-800);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            z-index: 2000;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.success {
            background: var(--success);
        }

        .toast.error {
            background: var(--danger);
        }

        /* Loading overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--gray-200);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 12px;
            }
            
            .header {
                padding: 16px;
            }
            
            .header h1 {
                font-size: 20px;
            }
            
            .tabs {
                overflow-x: auto;
            }
            
            .tab {
                white-space: nowrap;
                padding: 10px 16px;
            }
            
            .action-bar {
                flex-direction: column;
                align-items: stretch;
            }

            .btn-lg {
                width: 100%;
                justify-content: center;
            }
        }

        /* Print styles */
        @media print {
            body {
                background: white;
            }
            
            .tabs, .action-bar, .btn, .header, .legend {
                display: none !important;
            }
            
            .card {
                box-shadow: none;
                border: 1px solid #ddd;
            }

            .schedule-cell:hover {
                background: white;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü¶∑ ÁâôÈÜ´Ë®∫ÊâÄÊéíÁè≠Á≥ªÁµ±</h1>
            <p>2026Âπ¥1Êúà Âä©ÁêÜÁè≠Ë°®ÁÆ°ÁêÜ</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('schedule')">üìÖ ÊéíÁè≠Ë°®</button>
            <button class="tab" onclick="switchTab('employees')">üë• Âì°Â∑•ÁÆ°ÁêÜ</button>
            <button class="tab" onclick="switchTab('leave')">üèñÔ∏è Ë´ãÂÅáË®≠ÂÆö</button>
            <button class="tab" onclick="switchTab('stats')">üìä Áµ±Ë®àÂ†±Ë°®</button>
        </div>

        <!-- Schedule Panel -->
        <div id="panel-schedule" class="panel active">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Âä©ÁêÜÁè≠Ë°® - 2026Âπ¥1Êúà</div>
                    <div class="action-bar">
                        <button class="btn btn-success btn-lg" onclick="autoSchedule()">
                            ‚ö° ‰∏ÄÈçµÊô∫ËÉΩÊéíÁè≠
                        </button>
                        <button class="btn btn-outline" onclick="clearSchedule()">
                            üóëÔ∏è Ê∏ÖÈô§Áè≠Ë°®
                        </button>
                        <button class="btn btn-outline" onclick="window.print()">
                            üñ®Ô∏è ÂàóÂç∞
                        </button>
                    </div>
                </div>

                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: var(--counter-light); border: 1px solid var(--counter);"></div>
                        <span>Ê´ÉÊ™ØÁè≠</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: var(--follow-light); border: 1px solid var(--follow);"></div>
                        <span>Ë∑üË®∫Áè≠</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: var(--danger-light); border: 1px dashed var(--danger);"></div>
                        <span>‰∫∫ÂäõÁº∫È°ç</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: var(--gray-200);"></div>
                        <span>‰ºëË®∫</span>
                    </div>
                </div>

                <div class="schedule-container">
                    <table class="schedule-table" id="schedule-table">
                        <!-- Generated by JS -->
                    </table>
                </div>
            </div>
        </div>

        <!-- Employees Panel -->
        <div id="panel-employees" class="panel">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Âì°Â∑•ÁÆ°ÁêÜ</div>
                    <button class="btn btn-primary" onclick="openAddEmployeeModal()">
                        ‚ûï Êñ∞Â¢ûÂì°Â∑•
                    </button>
                </div>
                <div class="employee-grid" id="employee-list">
                    <!-- Generated by JS -->
                </div>
            </div>
        </div>

        <!-- Leave Panel -->
        <div id="panel-leave" class="panel">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Ë´ãÂÅáË®≠ÂÆö - 2026Âπ¥1Êúà</div>
                    <div class="action-bar">
                        <select class="form-input" style="width: auto; min-width: 150px;" id="leave-employee-select" onchange="renderLeaveCalendar()">
                            <!-- Generated by JS -->
                        </select>
                        <button class="btn btn-outline" onclick="clearEmployeeLeave()">Ê∏ÖÈô§Ê≠§Âì°Â∑•Ë´ãÂÅá</button>
                    </div>
                </div>
                <p style="color: var(--gray-500); font-size: 14px; margin-bottom: 16px;">
                    üí° ÈªûÊìäÊó•ÊúüÂèØÊ®ôË®òË©≤Âì°Â∑•‰∏çËÉΩ‰∏äÁè≠ÁöÑÊó•ÊúüÔºàÁ¥ÖËâ≤ÁÇ∫Â∑≤Ë´ãÂÅáÔºâ
                </p>
                <div class="leave-calendar" id="leave-calendar">
                    <!-- Generated by JS -->
                </div>
                <div id="leave-summary" style="margin-top: 20px; padding: 16px; background: var(--gray-50); border-radius: 8px;">
                    <!-- Generated by JS -->
                </div>
            </div>
        </div>

        <!-- Stats Panel -->
        <div id="panel-stats" class="panel">
            <div class="summary-panel">
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-value" id="total-sessions">71</div>
                        <div class="summary-label">Êú¨ÊúàÁ∏ΩË®∫Êï∏</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value" id="total-required">284</div>
                        <div class="summary-label">ÈúÄÊ±Ç‰∫∫Ê¨°</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value" id="total-assigned">0</div>
                        <div class="summary-label">Â∑≤Êéí‰∫∫Ê¨°</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value" id="total-vacancy">284</div>
                        <div class="summary-label">Áº∫È°ç‰∫∫Ê¨°</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">Âì°Â∑•Ë®∫Êï∏Áµ±Ë®à</div>
                    <span style="color: var(--gray-500); font-size: 14px;">ÁõÆÊ®ôÔºöÊØè‰∫∫ 42 Ë®∫</span>
                </div>
                <div class="stats-grid" id="stats-grid">
                    <!-- Generated by JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Employee Modal -->
    <div class="modal-overlay" id="employee-modal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="employee-modal-title">Êñ∞Â¢ûÂì°Â∑•</div>
                <button class="modal-close" onclick="closeModal('employee-modal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Âì°Â∑•ÂßìÂêç</label>
                <input type="text" class="form-input" id="employee-name-input" placeholder="Ë´ãËº∏ÂÖ•ÂßìÂêç">
            </div>
            <input type="hidden" id="employee-edit-id">
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('employee-modal')">ÂèñÊ∂à</button>
                <button class="btn btn-primary" onclick="saveEmployee()">ÂÑ≤Â≠ò</button>
            </div>
        </div>
    </div>

    <!-- Cell Edit Modal -->
    <div class="modal-overlay" id="cell-edit-modal">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <div class="modal-title" id="cell-edit-title">Á∑®ËºØÁè≠Ê¨°</div>
                <button class="modal-close" onclick="closeModal('cell-edit-modal')">&times;</button>
            </div>
            <div id="cell-edit-content">
                <!-- Generated by JS -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="closeModal('cell-edit-modal')">ÂÆåÊàê</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <script>
        // ===== DATA =====
        let employees = [
            { id: 1, name: 'ÁéãÂ∞èÁæé' },
            { id: 2, name: 'Êûó‰Ω≥Áé≤' },
            { id: 3, name: 'Èô≥ÈõÖÂ©∑' },
            { id: 4, name: 'ÂºµÊÉ†Âêõ' },
            { id: 5, name: 'ÊùéÁæéÁé≤' },
            { id: 6, name: 'ÈªÉÊ∑ëËä¨' }
        ];

        let leaves = {}; // { Âì°Â∑•ID: [Êó•ÊúüÈô£Âàó] }

        let schedule = {}; // { 'YYYY-MM-DD_session': { counter: [Âì°Â∑•ID], follow: [Âì°Â∑•ID] } }

        const YEAR = 2026;
        const MONTH = 1;
        const TARGET_SESSIONS = 42;
        const STAFF_PER_SESSION = { counter: 1, follow: 3 }; // ÊØèË®∫ÈúÄÊ±Ç

        const HOLIDAYS = ['2026-01-01']; // ÂúãÂÆöÂÅáÊó•
        const SESSIONS = ['morning', 'afternoon', 'evening'];
        const SESSION_NAMES = { morning: 'Êó©Ë®∫', afternoon: 'ÂçàË®∫', evening: 'ÊôöË®∫' };
        const SESSION_TIMES = { 
            morning: '09:30-12:30', 
            afternoon: '14:00-17:30', 
            evening: '18:00-21:30' 
        };

        // ===== UTILITIES =====
        function getDaysInMonth(year, month) {
            return new Date(year, month, 0).getDate();
        }

        function getWeekday(year, month, day) {
            return new Date(year, month - 1, day).getDay();
        }

        function formatDate(day) {
            return `${YEAR}-${String(MONTH).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
        }

        function isHoliday(dateStr) {
            return HOLIDAYS.includes(dateStr);
        }

        function isSunday(day) {
            return getWeekday(YEAR, MONTH, day) === 0;
        }

        function isSaturday(day) {
            return getWeekday(YEAR, MONTH, day) === 6;
        }

        function getSessionsForDay(day) {
            if (isSunday(day) || isHoliday(formatDate(day))) return [];
            if (isSaturday(day)) return ['morning', 'afternoon'];
            return ['morning', 'afternoon', 'evening'];
        }

        function getWeekdayName(day) {
            const names = ['Êó•', '‰∏Ä', '‰∫å', '‰∏â', 'Âõõ', '‰∫î', 'ÂÖ≠'];
            return names[getWeekday(YEAR, MONTH, day)];
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast ' + type + ' show';
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function showLoading() {
            document.getElementById('loading-overlay').classList.add('active');
        }

        function hideLoading() {
            document.getElementById('loading-overlay').classList.remove('active');
        }

        // ===== EMPLOYEE MANAGEMENT =====
        function renderEmployeeList() {
            const container = document.getElementById('employee-list');
            container.innerHTML = employees.map(emp => {
                const sessionCount = countEmployeeSessions(emp.id);
                const statusText = sessionCount >= TARGET_SESSIONS ? '‚úì Â∑≤ÈÅîÊ®ô' : `Â∑Æ ${TARGET_SESSIONS - sessionCount} Ë®∫`;
                const statusColor = sessionCount >= TARGET_SESSIONS ? 'var(--success)' : 'var(--danger)';
                
                return `
                    <div class="employee-card">
                        <div class="employee-avatar">${emp.name.charAt(0)}</div>
                        <div class="employee-info">
                            <div class="employee-name">${emp.name}</div>
                            <div class="employee-stats">
                                Â∑≤Êéí <strong>${sessionCount}</strong> Ë®∫ / ÁõÆÊ®ô ${TARGET_SESSIONS} Ë®∫
                                <span style="color: ${statusColor}; margin-left: 8px;">${statusText}</span>
                            </div>
                        </div>
                        <div class="employee-actions">
                            <button class="btn btn-outline btn-sm" onclick="editEmployee(${emp.id})">‚úèÔ∏è Á∑®ËºØ</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteEmployee(${emp.id})">üóëÔ∏è</button>
                        </div>
                    </div>
                `;
            }).join('');

            // Update leave select
            updateLeaveSelect();
        }

        function updateLeaveSelect() {
            const select = document.getElementById('leave-employee-select');
            const currentValue = select.value;
            select.innerHTML = employees.map(emp => 
                `<option value="${emp.id}">${emp.name}</option>`
            ).join('');
            if (currentValue && employees.find(e => e.id === parseInt(currentValue))) {
                select.value = currentValue;
            }
        }

        function openAddEmployeeModal() {
            document.getElementById('employee-modal-title').textContent = 'Êñ∞Â¢ûÂì°Â∑•';
            document.getElementById('employee-name-input').value = '';
            document.getElementById('employee-edit-id').value = '';
            openModal('employee-modal');
            document.getElementById('employee-name-input').focus();
        }

        function editEmployee(id) {
            const emp = employees.find(e => e.id === id);
            if (!emp) return;
            
            document.getElementById('employee-modal-title').textContent = 'Á∑®ËºØÂì°Â∑•';
            document.getElementById('employee-name-input').value = emp.name;
            document.getElementById('employee-edit-id').value = id;
            openModal('employee-modal');
            document.getElementById('employee-name-input').focus();
        }

        function saveEmployee() {
            const name = document.getElementById('employee-name-input').value.trim();
            const editId = document.getElementById('employee-edit-id').value;

            if (!name) {
                showToast('Ë´ãËº∏ÂÖ•Âì°Â∑•ÂßìÂêç', 'error');
                return;
            }

            if (editId) {
                const emp = employees.find(e => e.id === parseInt(editId));
                if (emp) {
                    emp.name = name;
                    showToast(`Âì°Â∑•„Äå${name}„ÄçÂ∑≤Êõ¥Êñ∞`);
                }
            } else {
                const maxId = employees.reduce((max, e) => Math.max(max, e.id), 0);
                employees.push({ id: maxId + 1, name });
                showToast(`Âì°Â∑•„Äå${name}„ÄçÂ∑≤Êñ∞Â¢û`);
            }

            closeModal('employee-modal');
            renderEmployeeList();
            renderSchedule();
            renderStats();
            renderLeaveCalendar();
        }

        function deleteEmployee(id) {
            const emp = employees.find(e => e.id === id);
            if (!emp) return;
            
            if (!confirm(`Á¢∫ÂÆöË¶ÅÂà™Èô§Âì°Â∑•„Äå${emp.name}„ÄçÂóéÔºü\nÁõ∏ÈóúÊéíÁè≠Ë≥áÊñô‰πüÊúÉË¢´Ê∏ÖÈô§„ÄÇ`)) return;
            
            employees = employees.filter(e => e.id !== id);
            delete leaves[id];
            
            // Remove from schedule
            Object.keys(schedule).forEach(key => {
                if (schedule[key]) {
                    schedule[key].counter = schedule[key].counter.filter(eid => eid !== id);
                    schedule[key].follow = schedule[key].follow.filter(eid => eid !== id);
                }
            });

            showToast(`Âì°Â∑•„Äå${emp.name}„ÄçÂ∑≤Âà™Èô§`);
            renderEmployeeList();
            renderSchedule();
            renderStats();
            renderLeaveCalendar();
        }

        // ===== LEAVE MANAGEMENT =====
        function renderLeaveCalendar() {
            const container = document.getElementById('leave-calendar');
            const empId = parseInt(document.getElementById('leave-employee-select').value);
            
            if (!empId) {
                container.innerHTML = '<p style="color: var(--gray-500);">Ë´ãÂÖàÈÅ∏ÊìáÂì°Â∑•</p>';
                return;
            }
            
            const empLeaves = leaves[empId] || [];
            const emp = employees.find(e => e.id === empId);

            const daysInMonth = getDaysInMonth(YEAR, MONTH);
            const firstDay = getWeekday(YEAR, MONTH, 1);

            let html = `
                <div class="leave-calendar-header">Êó•</div>
                <div class="leave-calendar-header">‰∏Ä</div>
                <div class="leave-calendar-header">‰∫å</div>
                <div class="leave-calendar-header">‰∏â</div>
                <div class="leave-calendar-header">Âõõ</div>
                <div class="leave-calendar-header">‰∫î</div>
                <div class="leave-calendar-header">ÂÖ≠</div>
            `;

            // Empty cells before first day
            for (let i = 0; i < firstDay; i++) {
                html += '<div class="leave-day empty"></div>';
            }

            // Days
            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = formatDate(day);
                const sunday = isSunday(day);
                const holiday = isHoliday(dateStr);
                const selected = empLeaves.includes(dateStr);
                
                let classes = 'leave-day';
                if (sunday) classes += ' sunday';
                if (holiday) classes += ' holiday';
                if (selected) classes += ' selected';

                const clickable = !sunday && !holiday;
                const title = holiday ? 'ÂúãÂÆöÂÅáÊó•' : (sunday ? 'ÈÄ±Êó•‰ºëË®∫' : (selected ? 'Â∑≤Ë´ãÂÅá - ÈªûÊìäÂèñÊ∂à' : 'ÈªûÊìäË®≠ÂÆöË´ãÂÅá'));
                
                html += `
                    <div class="${classes}" 
                         title="${title}"
                         ${clickable ? `onclick="toggleLeave(${day})"` : ''}>
                        ${day}
                    </div>
                `;
            }

            container.innerHTML = html;

            // Update leave summary
            const summaryEl = document.getElementById('leave-summary');
            const leaveDays = empLeaves.length;
            summaryEl.innerHTML = `
                <strong>${emp ? emp.name : ''}</strong> Êú¨ÊúàË´ãÂÅáÔºö<strong style="color: ${leaveDays > 0 ? 'var(--danger)' : 'var(--success)'};">${leaveDays}</strong> Â§©
                ${leaveDays > 0 ? `<br><small style="color: var(--gray-500);">Ë´ãÂÅáÊó•ÊúüÔºö${empLeaves.map(d => d.split('-')[2]).join(', ')} Êó•</small>` : ''}
            `;
        }

        function toggleLeave(day) {
            const empId = parseInt(document.getElementById('leave-employee-select').value);
            const dateStr = formatDate(day);

            if (!leaves[empId]) leaves[empId] = [];

            const idx = leaves[empId].indexOf(dateStr);
            if (idx > -1) {
                leaves[empId].splice(idx, 1);
                showToast(`Â∑≤ÂèñÊ∂à ${day} Êó•Ë´ãÂÅá`);
            } else {
                leaves[empId].push(dateStr);
                showToast(`Â∑≤Ë®≠ÂÆö ${day} Êó•Ë´ãÂÅá`);
            }

            renderLeaveCalendar();
        }

        function clearEmployeeLeave() {
            const empId = parseInt(document.getElementById('leave-employee-select').value);
            const emp = employees.find(e => e.id === empId);
            
            if (!emp) return;
            
            if (confirm(`Á¢∫ÂÆöË¶ÅÊ∏ÖÈô§„Äå${emp.name}„ÄçÁöÑÊâÄÊúâË´ãÂÅáÂóéÔºü`)) {
                leaves[empId] = [];
                showToast(`Â∑≤Ê∏ÖÈô§„Äå${emp.name}„ÄçÁöÑÊâÄÊúâË´ãÂÅá`);
                renderLeaveCalendar();
            }
        }

        // ===== SCHEDULE =====
        function renderSchedule() {
            const table = document.getElementById('schedule-table');
            const daysInMonth = getDaysInMonth(YEAR, MONTH);

            let html = '<thead><tr><th>ÊôÇÊÆµ</th>';
            
            // Headers
            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = formatDate(day);
                const sunday = isSunday(day);
                const saturday = isSaturday(day);
                const holiday = isHoliday(dateStr);

                let headerClass = 'day-header';
                if (holiday) headerClass += ' holiday';
                else if (sunday) headerClass += ' sunday';
                else if (saturday) headerClass += ' saturday';

                html += `
                    <th class="${headerClass}">
                        <div class="date">${day}</div>
                        <div class="weekday">ÈÄ±${getWeekdayName(day)}</div>
                        ${holiday ? '<div style="font-size:10px;">ÂÖÉÊó¶</div>' : ''}
                    </th>
                `;
            }
            html += '</tr></thead><tbody>';

            // Rows for each session
            SESSIONS.forEach(session => {
                html += `<tr>
                    <td>
                        <div class="session-label session-${session}">${SESSION_NAMES[session]}</div>
                        <div style="font-size:10px;color:var(--gray-500);">${SESSION_TIMES[session]}</div>
                    </td>`;

                for (let day = 1; day <= daysInMonth; day++) {
                    const dateStr = formatDate(day);
                    const sessions = getSessionsForDay(day);
                    const key = `${dateStr}_${session}`;

                    if (!sessions.includes(session)) {
                        html += `<td class="schedule-cell no-session">‰ºë</td>`;
                    } else {
                        const cellData = schedule[key] || { counter: [], follow: [] };
                        html += `<td class="schedule-cell" onclick="editCell('${key}')" title="ÈªûÊìäÁ∑®ËºØ">
                            <div class="staff-tags">
                                ${renderStaffTags(cellData)}
                            </div>
                        </td>`;
                    }
                }
                html += '</tr>';
            });

            html += '</tbody>';
            table.innerHTML = html;
        }

        function renderStaffTags(cellData) {
            let html = '';
            
            // Counter
            cellData.counter.forEach(empId => {
                const emp = employees.find(e => e.id === empId);
                if (emp) {
                    html += `<span class="staff-tag counter" title="Ê´ÉÊ™ØÁè≠">Ê´É:${emp.name}</span>`;
                }
            });

            // Follow
            cellData.follow.forEach(empId => {
                const emp = employees.find(e => e.id === empId);
                if (emp) {
                    html += `<span class="staff-tag follow" title="Ë∑üË®∫Áè≠">${emp.name}</span>`;
                }
            });

            // Vacancies
            const counterVacancy = Math.max(0, STAFF_PER_SESSION.counter - cellData.counter.length);
            const followVacancy = Math.max(0, STAFF_PER_SESSION.follow - cellData.follow.length);

            for (let i = 0; i < counterVacancy; i++) {
                html += `<span class="vacancy-tag">Ê´ÉÁº∫</span>`;
            }
            for (let i = 0; i < followVacancy; i++) {
                html += `<span class="vacancy-tag">Ë®∫Áº∫</span>`;
            }

            return html;
        }

        function editCell(key) {
            const [dateStr, session] = key.split('_');
            const day = parseInt(dateStr.split('-')[2]);
            
            if (!schedule[key]) {
                schedule[key] = { counter: [], follow: [] };
            }
            
            const cellData = schedule[key];

            document.getElementById('cell-edit-title').textContent = 
                `Á∑®ËºØÁè≠Ê¨°Ôºö${MONTH}Êúà${day}Êó• ${SESSION_NAMES[session]}`;

            let html = `
                <div style="margin-bottom: 20px;">
                    <h4 style="font-size: 14px; color: var(--counter); margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                        <span style="width: 12px; height: 12px; background: var(--counter); border-radius: 3px;"></span>
                        Ê´ÉÊ™ØÁè≠ÔºàÈúÄÊ±Ç ${STAFF_PER_SESSION.counter} ‰∫∫ÔºåÂ∑≤ÈÅ∏ ${cellData.counter.length} ‰∫∫Ôºâ
                    </h4>
                    <div class="checkbox-group">
            `;

            employees.forEach(emp => {
                const isAssignedCounter = cellData.counter.includes(emp.id);
                const isAssignedFollow = cellData.follow.includes(emp.id);
                const isOnLeave = (leaves[emp.id] || []).includes(dateStr);
                const isDisabled = isOnLeave || isAssignedFollow;
                
                let labelClass = 'checkbox-label';
                if (isAssignedCounter) labelClass += ' checked';
                if (isDisabled) labelClass += ' disabled';
                
                html += `
                    <label class="${labelClass}">
                        <input type="checkbox" 
                               ${isAssignedCounter ? 'checked' : ''}
                               ${isDisabled ? 'disabled' : ''}
                               onchange="toggleAssignment('${key}', ${emp.id}, 'counter')">
                        ${emp.name}
                        ${isOnLeave ? '<small style="color:var(--danger);">(Ë´ãÂÅá)</small>' : ''}
                        ${isAssignedFollow ? '<small style="color:var(--follow);">(Ë∑üË®∫)</small>' : ''}
                    </label>
                `;
            });

            html += `
                    </div>
                </div>
                <div>
                    <h4 style="font-size: 14px; color: var(--follow); margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                        <span style="width: 12px; height: 12px; background: var(--follow); border-radius: 3px;"></span>
                        Ë∑üË®∫Áè≠ÔºàÈúÄÊ±Ç ${STAFF_PER_SESSION.follow} ‰∫∫ÔºåÂ∑≤ÈÅ∏ ${cellData.follow.length} ‰∫∫Ôºâ
                    </h4>
                    <div class="checkbox-group">
            `;

            employees.forEach(emp => {
                const isAssignedFollow = cellData.follow.includes(emp.id);
                const isAssignedCounter = cellData.counter.includes(emp.id);
                const isOnLeave = (leaves[emp.id] || []).includes(dateStr);
                const isDisabled = isOnLeave || isAssignedCounter;
                
                let labelClass = 'checkbox-label';
                if (isAssignedFollow) labelClass += ' checked';
                if (isDisabled) labelClass += ' disabled';
                
                html += `
                    <label class="${labelClass}">
                        <input type="checkbox" 
                               ${isAssignedFollow ? 'checked' : ''}
                               ${isDisabled ? 'disabled' : ''}
                               onchange="toggleAssignment('${key}', ${emp.id}, 'follow')">
                        ${emp.name}
                        ${isOnLeave ? '<small style="color:var(--danger);">(Ë´ãÂÅá)</small>' : ''}
                        ${isAssignedCounter ? '<small style="color:var(--counter);">(Ê´ÉÊ™Ø)</small>' : ''}
                    </label>
                `;
            });

            html += '</div></div>';

            document.getElementById('cell-edit-content').innerHTML = html;
            openModal('cell-edit-modal');
        }

        function toggleAssignment(key, empId, role) {
            if (!schedule[key]) {
                schedule[key] = { counter: [], follow: [] };
            }

            const idx = schedule[key][role].indexOf(empId);
            if (idx > -1) {
                schedule[key][role].splice(idx, 1);
            } else {
                schedule[key][role].push(empId);
            }

            // Re-render the modal content
            editCell(key);
            renderSchedule();
            renderStats();
            renderEmployeeList();
        }

        // ===== AUTO SCHEDULE =====
        function autoSchedule() {
            if (!confirm('Á¢∫ÂÆöË¶ÅÂü∑Ë°åÊô∫ËÉΩÊéíÁè≠ÂóéÔºü\n\nÈÄôÂ∞áÊúÉÔºö\n‚Ä¢ Ê∏ÖÈô§ÁèæÊúâÁè≠Ë°®\n‚Ä¢ Ëá™ÂãïÂàÜÈÖç‰∫∫Âäõ\n‚Ä¢ Áº∫È°çÂÑ™ÂÖàÂÆâÊéíÂú®Êó©Ë®∫')) return;

            showLoading();

            // Use setTimeout to allow UI to update
            setTimeout(() => {
                schedule = {};
                const daysInMonth = getDaysInMonth(YEAR, MONTH);

                // Calculate all available sessions
                const allSessions = [];
                for (let day = 1; day <= daysInMonth; day++) {
                    const dateStr = formatDate(day);
                    getSessionsForDay(day).forEach(session => {
                        allSessions.push({ day, dateStr, session, key: `${dateStr}_${session}` });
                    });
                }

                // Initialize schedule
                allSessions.forEach(({ key }) => {
                    schedule[key] = { counter: [], follow: [] };
                });

                // Track employee session counts
                const empCounts = {};
                employees.forEach(emp => empCounts[emp.id] = 0);

                // Sort sessions: prioritize afternoon/evening over morning (to leave vacancies in morning)
                const sessionPriority = { evening: 0, afternoon: 1, morning: 2 };
                const sortedSessions = [...allSessions].sort((a, b) => 
                    sessionPriority[a.session] - sessionPriority[b.session]
                );

                // First pass: assign staff evenly
                sortedSessions.forEach(({ dateStr, session, key }) => {
                    // Get available employees (not on leave, not at target, not already assigned today in same role)
                    const getAvailable = () => {
                        return employees.filter(emp => {
                            const onLeave = (leaves[emp.id] || []).includes(dateStr);
                            const atTarget = empCounts[emp.id] >= TARGET_SESSIONS;
                            const alreadyAssigned = schedule[key].counter.includes(emp.id) || 
                                                   schedule[key].follow.includes(emp.id);
                            return !onLeave && !atTarget && !alreadyAssigned;
                        }).map(emp => emp.id);
                    };

                    // Sort by current count (lowest first for balance)
                    let available = getAvailable();
                    available.sort((a, b) => empCounts[a] - empCounts[b]);

                    // Assign counter (1 person)
                    if (available.length > 0) {
                        const counterId = available.shift();
                        schedule[key].counter.push(counterId);
                        empCounts[counterId]++;
                    }

                    // Refresh available list
                    available = getAvailable();
                    available.sort((a, b) => empCounts[a] - empCounts[b]);

                    // Assign follow (3 people)
                    for (let i = 0; i < STAFF_PER_SESSION.follow && available.length > 0; i++) {
                        const followId = available.shift();
                        schedule[key].follow.push(followId);
                        empCounts[followId]++;
                    }
                });

                hideLoading();
                renderSchedule();
                renderStats();
                renderEmployeeList();

                // Calculate results
                const totalAssigned = Object.values(empCounts).reduce((a, b) => a + b, 0);
                const totalVacancy = 284 - totalAssigned;

                showToast(`Êô∫ËÉΩÊéíÁè≠ÂÆåÊàêÔºÅÂ∑≤Êéí ${totalAssigned} ‰∫∫Ê¨°ÔºåÁº∫È°ç ${totalVacancy} ‰∫∫Ê¨°ÔºàÈõÜ‰∏≠Âú®Êó©Ë®∫Ôºâ`, 'success');
            }, 100);
        }

        function clearSchedule() {
            if (!confirm('Á¢∫ÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâÁè≠Ë°®ÂóéÔºü')) return;
            schedule = {};
            renderSchedule();
            renderStats();
            renderEmployeeList();
            showToast('Áè≠Ë°®Â∑≤Ê∏ÖÈô§');
        }

        // ===== STATS =====
        function countEmployeeSessions(empId) {
            let count = 0;
            Object.values(schedule).forEach(cell => {
                if (cell && cell.counter && cell.counter.includes(empId)) count++;
                if (cell && cell.follow && cell.follow.includes(empId)) count++;
            });
            return count;
        }

        function renderStats() {
            const grid = document.getElementById('stats-grid');
            
            grid.innerHTML = employees.map(emp => {
                const count = countEmployeeSessions(emp.id);
                let statusClass = '';
                let statusIcon = '';
                
                if (count === TARGET_SESSIONS) {
                    statusClass = 'complete';
                    statusIcon = '‚úì';
                } else if (count > TARGET_SESSIONS) {
                    statusClass = 'over';
                    statusIcon = '‚ö†';
                } else {
                    statusClass = 'under';
                    statusIcon = '';
                }

                return `
                    <div class="stat-card ${statusClass}">
                        <div class="stat-name">${emp.name} ${statusIcon}</div>
                        <div class="stat-value">${count}</div>
                        <div class="stat-target">/ ${TARGET_SESSIONS} Ë®∫</div>
                    </div>
                `;
            }).join('');

            // Update summary
            const totalAssigned = employees.reduce((sum, emp) => sum + countEmployeeSessions(emp.id), 0);
            document.getElementById('total-assigned').textContent = totalAssigned;
            document.getElementById('total-vacancy').textContent = Math.max(0, 284 - totalAssigned);
        }

        // ===== MODAL =====
        function openModal(id) {
            document.getElementById(id).classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
            document.body.style.overflow = '';
        }

        // Close modal on overlay click
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    overlay.classList.remove('active');
                    document.body.style.overflow = '';
                }
            });
        });

        // Close modal on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal-overlay.active').forEach(modal => {
                    modal.classList.remove('active');
                });
                document.body.style.overflow = '';
            }
        });

        // ===== TAB =====
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            
            document.querySelector(`.tab[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(`panel-${tabName}`).classList.add('active');

            if (tabName === 'leave') renderLeaveCalendar();
            if (tabName === 'stats') renderStats();
            if (tabName === 'employees') renderEmployeeList();
        }

        // ===== INIT =====
        function init() {
            renderEmployeeList();
            renderSchedule();
            renderStats();
            renderLeaveCalendar();
            
            console.log('ÁâôÈÜ´Ë®∫ÊâÄÊéíÁè≠Á≥ªÁµ±Â∑≤ËºâÂÖ•');
            console.log('Âì°Â∑•‰∫∫Êï∏:', employees.length);
            console.log('ÁõÆÊ®ôË®∫Êï∏:', TARGET_SESSIONS);
        }

        // Enter key to save employee
        document.getElementById('employee-name-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                saveEmployee();
            }
        });

        init();
    </script>
</body>
</html>
